
---
title: "Extracción de metadatos usando rcrossref"
author: "Yusnelkis Milanés Guisado"
date: "Fecha"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# CARGA DE DATOS Y EXTRACCIÓN DE METADATOS USANDO RCROSSREF

## Paso 1: Instalación y carga del paquete `rcrossref`

Primero, asegurémonos de que el paquete `rcrossref` esté instalado y cargado en tu entorno de trabajo.

```{r}
# Verificamos si el paquete está instalado; si no lo está, se instala
if(!require(rcrossref)) {
  install.packages("rcrossref")
}

# Cargar el paquete
library(rcrossref)
```

## Paso 2: Búsqueda de un artículo mediante DOI

En este paso, utilizamos el DOI (Identificador de Objeto Digital) para buscar los metadatos de un artículo. El DOI es un identificador único que nos permite acceder a la información completa del artículo.

```{r}
# DOI del artículo
doi <- "10.1038/s41586-020-2649-2"

# Obtener los metadatos del artículo mediante el DOI
article_metadata <- cr_works(dois = doi)

# Mostrar los metadatos completos
print(article_metadata$data)
```

## Paso 3: Extracción de información clave

Una vez obtenidos los metadatos, podemos extraer información clave como el título del artículo, los autores y la fecha de publicación.

### Extracción del título del artículo

```{r}
# Extraer título
titulo <- article_metadata$data$title
print(paste("Título:", titulo))
```

### Extracción de la lista de autores

```{r}
# Extraer lista de autores
autores <- article_metadata$data$author
autores_nombres <- sapply(autores, function(x) paste(x$given, x$family))
print("Autores:")
print(autores_nombres)
```

### Extracción de la fecha de publicación

```{r}
# Extraer fecha de publicación
fecha_publicacion <- article_metadata$data$published
print(paste("Fecha de publicación:", fecha_publicacion))
```

## Paso 4: Búsqueda de artículos por autor

Ahora vamos a buscar artículos publicados por un autor específico. En este caso, tomaremos como ejemplo a "John P. A. Ioannidis".

```{r}
# Autor de ejemplo
autor_nombre <- "John P. A. Ioannidis"

# Búsqueda de artículos por el autor
resultados_autor <- cr_works(query = autor_nombre)

# Mostrar el número de resultados encontrados
print(paste("Número de artículos encontrados para", autor_nombre, ":", resultados_autor$meta$total_results))

# Mostrar títulos de los primeros 5 artículos
titulos_articulos <- resultados_autor$data$title[1:5]
print("Títulos de los primeros 5 artículos:")
print(titulos_articulos)
```

## Paso 5: Guardar los resultados en un DataFrame

Para trabajar con los resultados de forma más cómoda, los convertimos en un `data.frame`.

```{r}
# Convertir los resultados en un data.frame
articulos_dF <- as.data.frame(resultados_autor$data)
View(articulos_dF)
```

## Paso 6: Limpieza de las columnas que contienen listas

Algunas de las columnas en el `data.frame` pueden contener listas o estructuras complejas, lo que puede dificultar su análisis. Por eso, vamos a convertir estas listas en texto plano.

### Convertir listas o estructuras complejas a texto

```{r}
# Función para convertir listas a texto o NA si está vacío
convertir_a_texto <- function(columna) {
  sapply(columna, function(x) {
    if (is.list(x)) {
      # Si es una lista, la convertimos a un texto concatenado
      paste(unlist(x), collapse = "; ")
    } else if (length(x) == 0 || is.null(x)) {
      # Si está vacío o es nulo, devolvemos NA
      NA
    } else {
      # Si no es lista, devolver el valor tal cual
      x
    }
  })
}

# Aplicar la función a todas las columnas del data.frame
articulos_dB_limpio <- as.data.frame(lapply(articulos_dF, convertir_a_texto))
View(articulos_dB_limpio)
```

## Paso 7: Exportar el DataFrame a un archivo CSV

Finalmente, exportamos el `data.frame` limpio a un archivo CSV para poder usar los datos posteriormente.

```{r}
# Exportar el DataFrame a un archivo CSV
write.csv(articulos_dB_limpio, "articulos_ioannidis.csv", row.names = FALSE)
```

---

Con esto habrás completado el proceso de extracción y limpieza de metadatos usando `rcrossref`. Puedes modificar el código según sea necesario para otros DOIs o autores.
